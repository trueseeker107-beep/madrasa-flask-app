{% extends "base.html" %}
{% block content %}
<section>
  <h2>Recent Entries</h2>
  <table>
    <thead>
      <tr>
        <th>ID</th>
        <th>Programme</th>
        <th>Student ID</th>
        <th>Name</th>
        <th>Score</th>
        <th>Remarks</th>
        <th>Time</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody>
    {% for row in recent %}
      {# row = (id, programme_code, student_id, student_name, score, remarks, created_at) #}
      <tr>
        <td>{{ row[0] }}</td>
        <td>{{ row[1] }}</td>
        <td>{{ row[2] }}</td>
        <td>{{ row[3] }}</td>
        <td>{{ row[4] }}</td>
        <td>{{ row[5] or "" }}</td>
        <td>{{ row[6] }}</td>
        <td>
          <form method="post" action="{{ url_for('delete_score', score_id=row[0]) }}" onsubmit="return confirm('Delete entry #{{ row[0] }}?')">
            <button type="submit" class="danger">Delete</button>
          </form>
        </td>
      </tr>
    {% endfor %}
    </tbody>
  </table>
</section>

<section>
  <h2>Total Scores</h2>
  <table>
    <thead>
      <tr>
        <th>Student ID</th>
        <th>Name</th>
        <th>Total</th>
      </tr>
    </thead>
    <tbody>
    {% for row in totals %}
      {# row = (student_id, student_name, total) #}
      <tr>
        <td>{{ row[0] }}</td>
        <td>{{ row[1] }}</td>
        <td>{{ "%.2f"|format(row[2] or 0) }}</td>
      </tr>
    {% endfor %}
    </tbody>
  </table>
</section>
{% endblock %}